<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rabbit Cage Management</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <button onclick="goHome()">&#x1F3E0;</button>
        <span>Rabbit Cage Management</span>
    </header>

    <div id="cageDetails" style="display: none;">
        <form id="rabbitForm" onsubmit="saveData(event)">
            <!-- Profile Selector -->
            <div>
                <label for="profile">RABBIT PROFILE:</label>
                <select id="profile" name="profile" onchange="toggleProfileFields()">
                    <option value="doe">Rabbit Doe</option>
                    <option value="fattener">Rabbit Fattener</option>
                    <option value="breeder">Rabbit Breeder</option>
                </select>
            </div>

            <!-- Rabbit Doe Fields -->
            <div id="doeFields" style="display: none;">
                <div>
                    <label for="serialNumber">SERIAL NUMBER:</label>
                    <input type="text" id="serialNumber" name="serialNumber">
                </div>
                <div>
                    <label for="age">AGE:</label>
                    <input type="text" id="age" name="age">
                </div>
                <div>
                    <label for="dateOfBirth">DATE OF BIRTH:</label>
                    <input type="date" id="dateOfBirth" name="dateOfBirth">
                </div>
                <div>
                    <label for="gender">GENDER:</label>
                    <select id="gender" name="gender">
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
                <div>
                    <label for="family">RABBIT FAMILY:</label>
                    <input type="text" id="family" name="family">
                </div>
                <div>
                    <label>FOOD INTAKE:</label>
                    <label><input type="radio" name="foodIntakeDoe" value="normal"> NORMAL</label>
                    <label><input type="radio" name="foodIntakeDoe" value="irregular"> IRREGULAR</label>
                </div>
                <div>
                    <label for="weight">WEIGHT:</label>
                    <input type="text" id="weight" name="weight">
                </div>
                <div id="pregnantSection">
                    <label>PREGNANT:</label>
                    <label><input type="radio" name="pregnantDoe" value="yes" onclick="togglePregnancyDetails(true)"> YES</label>
                    <label><input type="radio" name="pregnantDoe" value="no" onclick="togglePregnancyDetails(false)"> NO</label>
                    <div id="pregnancyDetails" style="display: none;">
                        <div>
                            <label for="pregnancyStartDoe">START OF PREGNANCY:</label>
                            <input type="date" id="pregnancyStartDoe" name="pregnancyStartDoe" onchange="calculateDueDate('Doe')">
                        </div>
                        <div>
                            <label for="dueDateDoe">DUE DATE OF PREGNANCY:</label>
                            <input type="text" id="dueDateDoe" name="dueDateDoe" readonly>
                        </div>
                    </div>
                    <div id="notReadyMessage" style="display: none;">
                        <p>This rabbit is not ready for pregnancy.</p>
                    </div>
                </div>
            </div>

            <!-- Rabbit Fattener Section -->
            <div id="fattenerSection" style="display: none;">
                <div>
                    <label for="serialNumberFattener">SERIAL NUMBER:</label>
                    <input type="text" id="serialNumberFattener" name="serialNumberFattener">
                </div>
                <div>
                    <label for="breeds">BREEDS:</label>
                    <input type="text" id="breeds" name="breeds">
                </div>
                <div>
                    <label for="ageFattener">AGE:</label>
                    <input type="text" id="ageFattener" name="ageFattener">
                </div>
                <div>
                    <label for="dateOfBirthFattener">DATE OF BIRTH:</label>
                    <input type="date" id="dateOfBirthFattener" name="dateOfBirthFattener" onchange="checkMeatProduction()">
                </div>
                <div>
                    <label for="genderFattener">GENDER:</label>
                    <select id="genderFattener" name="genderFattener">
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
                <div>
                    <label for="familyFattener">RABBIT FAMILY:</label>
                    <input type="text" id="familyFattener" name="familyFattener">
                </div>
                <div>
                    <label>FOOD INTAKE:</label>
                    <label><input type="radio" name="foodIntakeFattener" value="normal"> NORMAL</label>
                    <label><input type="radio" name="foodIntakeFattener" value="irregular"> IRREGULAR</label>
                </div>
                <div>
                    <label for="weightFattener">WEIGHT:</label>
                    <input type="text" id="weightFattener" name="weightFattener">
                </div>
                <div id="readyForMeat" style="display: none;">
                    <p>This rabbit is ready for meat production.</p>
                </div>
                <div id="notReadyForMeat" style="display: none;">
                    <p style="font-weight: bold; border: 2px solid black; padding: 5px;">This rabbit is not ready for meat production.</p>
                </div>
            </div>

            <!-- Rabbit Breeder Section -->
            <div id="breederSection" style="display: none;">
                <div>
                    <label for="serialNumberBreeder">SERIAL NUMBER:</label>
                    <input type="text" id="serialNumberBreeder" name="serialNumberBreeder">
                </div>
                <div>
                    <label for="breedsBreeder">BREEDS:</label>
                    <input type="text" id="breedsBreeder" name="breedsBreeder">
                </div>
                <div>
                    <label for="ageBreeder">AGE:</label>
                    <input type="text" id="ageBreeder" name="ageBreeder">
                </div>
                <div>
                    <label for="dateOfBirthBreeder">DATE OF BIRTH:</label>
                    <input type="date" id="dateOfBirthBreeder" name="dateOfBirthBreeder" onchange="checkMatingEligibility()">
                </div>
                <div>
                    <label for="genderBreeder">GENDER:</label>
                    <select id="genderBreeder" name="genderBreeder">
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
                <div>
                    <label for="familyBreeder">RABBIT FAMILY:</label>
                    <input type="text" id="familyBreeder" name="familyBreeder">
                </div>
                <div>
                    <label>FOOD INTAKE:</label>
                    <label><input type="radio" name="foodIntakeBreeder" value="normal"> NORMAL</label>
                    <label><input type="radio" name="foodIntakeBreeder" value="irregular"> IRREGULAR</label>
                </div>
                <div>
                    <label for="weightBreeder">WEIGHT:</label>
                    <input type="text" id="weightBreeder" name="weightBreeder">
                </div>
                <div id="matingEligibilityMessage" style="display: none;"></div>
            </div>

            <div>
                <label for="note">NOTE:</label>
                <textarea id="note" name="note"></textarea>
            </div>
            <div class="buttons">
                <button type="submit">SUBMIT</button>
                <button type="button" onclick="clearForm()">CLEAR FORM</button>
                <button type="button" onclick="goHome()">CANCEL</button>
            </div>

            <!-- Delete Cage Button Inside the Profile -->
            <div class="buttons">
                <button type="button" onclick="deleteCageData()">DELETE CAGE</button>
            </div>
        </form>
    </div>

    <div id="homePage" class="cage-list" style="display: block;">
        <h2>CAGE MANAGEMENT</h2>
        <ul id="cageList"></ul> <!-- Container for dynamic cage list -->
        <button type="button" onclick="add
        <button type="button" onclick="addCage()">ADD CAGE</button>
    </div>

    <script>
        // Function to navigate to homepage
        function goHome() {
            document.getElementById("cageDetails").style.display = "none";
            document.getElementById("homePage").style.display = "block";
        }

        // Function to add a cage
        function addCage() {
            const cageList = document.getElementById("cageList");
            const cageId = `cage-${Date.now()}`;
            const cageItem = document.createElement("li");
            cageItem.id = cageId;
            cageItem.innerHTML = `
                Cage ${cageList.children.length + 1}
                <button onclick="openCage('${cageId}')">Open</button>
            `;
            cageList.appendChild(cageItem);
        }

        // Function to open a specific cage
        function openCage(cageId) {
            document.getElementById("cageDetails").style.display = "block";
            document.getElementById("homePage").style.display = "none";
            // Store current cage id for later actions (delete, etc.)
            document.getElementById("rabbitForm").dataset.cageId = cageId;
        }

        // Function to delete a cage
        function deleteCageData() {
            const cageId = document.getElementById("rabbitForm").dataset.cageId;
            if (cageId) {
                const cageItem = document.getElementById(cageId);
                if (cageItem) {
                    cageItem.remove();
                    alert('Cage deleted successfully!');
                    goHome(); // Go back to the homepage after deletion
                }
            }
        }

        // Function to clear the form
        function clearForm() {
            document.getElementById("rabbitForm").reset();
        }

        // Function to toggle form fields based on profile type
        function toggleProfileFields() {
            const profile = document.getElementById("profile").value;
            document.getElementById("doeFields").style.display = profile === "doe" ? "block" : "none";
            document.getElementById("fattenerSection").style.display = profile === "fattener" ? "block" : "none";
            document.getElementById("breederSection").style.display = profile === "breeder" ? "block" : "none";
        }

        // Function to save form data
        function saveData(event) {
            event.preventDefault();
            alert('Rabbit data saved successfully!');
        }

        // Mating Eligibility Logic for Rabbit Breeder
        function checkMatingEligibility() {
            const dob = document.getElementById("dateOfBirthBreeder").value;
            const ageInMonths = calculateAgeInMonths(dob);

            const message = document.getElementById("matingEligibilityMessage");
            if (ageInMonths >= 6) {
                message.innerHTML = "<p style='color: green;'>This rabbit is eligible for mating.</p>";
            } else {
                message.innerHTML = "<p style='color: red;'>This rabbit is not eligible for mating.</p>";
            }
            message.style.display = "block";
        }

        // Meat Production Readiness Logic for Rabbit Fattener
        function checkMeatProduction() {
            const dob = document.getElementById("dateOfBirthFattener").value;
            const ageInMonths = calculateAgeInMonths(dob);

            const readyForMeat = document.getElementById("readyForMeat");
            const notReadyForMeat = document.getElementById("notReadyForMeat");
            if (ageInMonths >= 3) {
                readyForMeat.style.display = "block";
                notReadyForMeat.style.display = "none";
            } else {
                readyForMeat.style.display = "none";
                notReadyForMeat.style.display = "block";
            }
        }

        // Pregnancy Date Calculation Logic
        function togglePregnancyDetails(isPregnant) {
            const details = document.getElementById("pregnancyDetails");
            details.style.display = isPregnant ? "block" : "none";
        }

        function calculateDueDate(type) {
            const pregnancyStart = document.getElementById(`pregnancyStart${type}`).value;
            if (pregnancyStart) {
                const startDate = new Date(pregnancyStart);
                const dueDate = new Date(startDate.setDate(startDate.getDate() + 31)); // 31-day gestation
                const formattedDueDate = dueDate.toISOString().split("T")[0];
                document.getElementById(`dueDate${type}`).value = formattedDueDate;
            }
        }

        // Utility function to calculate age in months
        function calculateAgeInMonths(dob) {
            const dobDate = new Date(dob);
            const today = new Date();
            const ageInMonths = (today.getFullYear() - dobDate.getFullYear()) * 12 + today.getMonth() - dobDate.getMonth();
            return ageInMonths;
        }
    </script>
</body>
</html>
